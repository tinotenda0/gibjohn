{% extends "base.html" %}

{% block content %}
    <div class="section">
    <div class="form">
<form method="POST" action="/register" id="registerForm">
    <div>
        <input type="email" name="email" placeholder="Email" autofocus required>
    </div>

    <div class="field">
        <input class="input is-large" type="text" name="name" placeholder="Name" required>
    </div>

    <div class="field">
        <label for="role">I am a:</label>
        <select id="role" name="role" required onchange="showBuzzword()">
            <option value="" disabled selected>Select your role</option>
            <option value="student">Student</option>
            <option value="tutor">Tutor</option>
        </select>
    </div>

    <div class="field" id="buzzDiv" style="display:none;">
        <input type="text" id="buzzword" name="buzzword" placeholder="Tutor buzzword" />
    </div>

    <div class="field">
        <input class="input is-large" type="password" name="password" placeholder="Password" required>
    </div>
    <button class="form-button">Sign Up</button>
    <p>
        Already have an account? <a href="/login">Login here</a>.
    </p>
    <div class="alert">
            <span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span>
            {% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
      {% for category, message in messages %}
        <div class="notification {{ category }}">
          {{ message }}
        </div>
      {% endfor %}
    </div>
  {% endif %}
{% endwith %}
</form>
<script>
    const tutorBuzzword = "iamarealtutor";

    function showBuzzword() {
        const role = document.getElementById("role").value;
        document.getElementById("buzzDiv").style.display = (role === "tutor") ? "block" : "none";
    }

    document.getElementById("registerForm").addEventListener("submit", function(event) {
        const role = document.getElementById("role").value;
        if (role === "tutor") {
            const buzzword = document.getElementById("buzzword").value.trim();
            if (buzzword !== tutorBuzzword) {
                alert("Incorrect buzzword. Please try again.");
                event.preventDefault();
                return false;
            }
        }
    });
</script>
        </div>
</div>
{% endblock %}